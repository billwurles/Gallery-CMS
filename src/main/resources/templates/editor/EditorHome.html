<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title th:text="|Editor Home - ${name}|"/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <link rel="stylesheet" th:href="@{/css/style.css}">

    <!-- jQuery, UI & UI CSS-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.14.1/jquery-ui.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.14.1/themes/base/jquery-ui.min.css">

</head>
<body>
<nav class="navbar">
    <div class="navbar-container container">
        <input type="checkbox" name="" id=""/>
        <div class="hamburger-lines">
            <span class="line line1"></span>
            <span class="line line2"></span>
            <span class="line line3"></span>
        </div>
        <ul class="menu-items">
            <li th:each="item : ${menuItems}" class="links">
                    <a href="#" th:href="@{${item.url}}" th:text="${item.name}" th:classappend="${item.url == '/${page}' ? 'active' : ''}"></a>
            </li>
        </ul>
        <h1 class="logo">
            <a href="/">AHC Web Editor</a>
        </h1>
    </div>
</nav>

<!-- Main Content -->
<div class="content">
    <h1 th:text="|${name}|"></h1>
    <p>This is where you edit your site, select a page <a href="/page">or create a new one</a></p>

    <h1>Rearrange Pages</h1>



<!--    <ul id="sortable">-->
<!--        <li>Item 1</li>-->
<!--        <li>Item 2</li>-->
<!--        <li>Item 3</li>-->
<!--        <li>Item 4</li>-->
<!--    </ul>-->

    <ul id="sortable">
        <li th:each="page : ${pages}"
        th:data-id="${page.order}"
        th:data-url="${page.url}"
        th:text="${page.title}">
        </li>
    </ul>

    <script>
        $(document).ready(function () {
    $("#sortable").sortable({
        update: function(event, ui) {
            // Generate the new order in 'order: url' format
            let order = {};
            $("#sortable li").each(function(index) {
                let pageUrl = $(this).data("url");  // Assuming the page URL is stored in 'data-url'
                order[index] = pageUrl;  // Store the index as the key (order) and page URL as the value
                });

                // Send the order as a JSON request via AJAX
                $.ajax({
                    url: '/rearrange', // URL to handle the request
                    type: 'POST',
                contentType: 'application/json', // Set content type to JSON
                data: JSON.stringify(order), // Send the new order as JSON
                    success: function(response) {
                        alert("Page order saved successfully!");
                    window.location.reload();  // Optionally reload page to reflect changes
                    },
                    error: function(xhr, status, error) {
                        alert("An error occurred while saving the order.");
                    }
                });
        }
            });
        });
    </script>
</div>

</body>

<style>
*,
*::after,
*::before {
box-sizing: border-box;
padding: 0;
margin: 0;
}

.html {
font-size: 62.5%;
}

.navbar input[type="checkbox"],
.navbar .hamburger-lines {
display: none;
}

.container {
max-width: 1200px;
width: 90%;
margin: auto;
}

.navbar {
/* box-shadow: 0px 5px 10px 0px #aaa; */
/* position: fixed; */
width: 100%;
background: #fff;
color: #000;
opacity: 0.85;
z-index: 100;
}

.navbar-container {
display: flex;
justify-content: space-between;
height: 64px;
align-items: center;
}

.menu-items {
order: 2;
display: flex;
flex-wrap: wrap;
align-items: center;
}
.logo {
order: 1;
font-size: 1.2rem;
}

.menu-items li {
list-style: none;
font-size: 1.2rem;
margin-left: 1rem;
padding-top: 5px;
}

.navbar a {
color: #2c3e50;
text-decoration: none;
font-weight: 500;
font-weight: bold;
/* transition: color 0.3s ease-in-out; */
}

.navbar a.router-link-exact-active {
color: #42b983;
}

.navbar a:hover {
color: #117964;
}

@media (max-width: 778px) {
.navbar {
opacity: 0.95;
}

.navbar-container input[type="checkbox"],
.navbar-container .hamburger-lines {
display: block;
}

.navbar-container {
display: block;
position: relative;
height: px;
}

.navbar-container input[type="checkbox"] {
position: absolute;
display: block;
height: 32px;
width: 30px;
top: 20px;
left: 20px;
z-index: 5;
opacity: 0;
cursor: pointer;
}

.navbar-container .hamburger-lines {
display: block;
height: 28px;
width: 35px;
position: absolute;
top: 20px;
left: 20px;
z-index: 2;
display: flex;
flex-direction: column;
justify-content: space-between;
}

.navbar-container .hamburger-lines .line {
display: block;
height: 4px;
width: 100%;
border-radius: 10px;
background: #333;
}

.navbar-container .hamburger-lines .line1 {
transform-origin: 0% 0%;
transition: transform 0.3s ease-in-out;
}

.navbar-container .hamburger-lines .line2 {
transition: transform 0.2s ease-in-out;
}

.navbar-container .hamburger-lines .line3 {
transform-origin: 0% 100%;
transition: transform 0.3s ease-in-out;
}

.navbar .menu-items {
padding-top: 100px;
background: #fff;
height: 100vh;
max-width: 300px;
transform: translate(-150%);
display: flex;
flex-direction: column;
margin-left: -40px;
padding-left: 40px;
transition: transform 0.5s ease-in-out;
box-shadow: 5px 0px 10px 0px #aaa;
overflow: scroll;
}

.navbar .menu-items li {
margin-bottom: 1.8rem;
font-size: 1.1rem;
font-weight: 500;
}

.logo {
position: absolute;
top: 18px;
right: 15px;
font-size: 1.5rem;
}

.navbar-container input[type="checkbox"]:checked ~ .menu-items {
transform: translateX(0);
}

.navbar-container input[type="checkbox"]:checked ~ .hamburger-lines .line1 {
transform: rotate(45deg);
}

.navbar-container input[type="checkbox"]:checked ~ .hamburger-lines .line2 {
transform: scaleY(0);
}

.navbar-container input[type="checkbox"]:checked ~ .hamburger-lines .line3 {
transform: rotate(-45deg);
}
}

@media (max-width: 500px) {
.navbar-container input[type="checkbox"]:checked ~ .logo {
display: none;
}
}
/* #nav {
display: flex;
align-items: center;
top: 0;
z-index: 1;
}

nav {
padding: 0px 30px;
}

nav a {
padding-bottom: 10px;
font-weight: bold;
color: #33404e;
text-decoration: none;
font-weight: bold;
}

nav a.active-nav-link {
color: #605f6c;
}

.nav-links {
display: flex;
flex-wrap: wrap;
padding-bottom: 5px;
}
.links {
padding-left: 20px;
padding-bottom: 10px;
list-style: none;
}
.links a:hover {
color: #706f7c;
}
.logo {
font-size: 20px;
color: darkslategray;
font-weight: bold;
} */

</style>
</html>